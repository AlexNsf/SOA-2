# SOA-2

### В данном репозитории находятся решения 2 и 4 заданий

Чтобы запустить только второе задание, нужно выполнить команду
`make run_first`. Чтобы добавить пользователя с кастомным именем,
необходимо сначала создать имейдж через `make build_image_for_custom_client`,
а затем поднять grpc сервер и 3+ клиентов с помощью команды 
`docker compose up proto_server proto_client_1 proto_client_2 proto_client_3` , после чего выполнить в другом терминале
`make add_custom_client`. Последняя команда запросит имя пользователя,
которое будет необходимо ввести в том же терминале. После получения ввода от пользователя
будет поднят новый контейнер-юзер с выбранным именем. Он будет подключен к той же дефолтной сети,
что и остальные контейнеры, и будет вести себя ровно так же. Чтобы следить за юзером с выбранным именем,
достаточно смотреть логи в том терминале, в котором он был запущен (логи остальных юзеров будут идти в том,
в котором был запущен `docker compose up ...`)

Для запуска четвертого задания достаточно выполнить
`docker compose up`

Чтобы удалить не нужные контейнеры выполните `make down`

### Структура
В папке contents находятся папки, необходимые для хранения пдф и аватарок
В файлах server.py и client.py находятся gRPC сервер и клиент соответсвенно
В файле mafia.py находится движок игры
Рест-сервер находится в rest_server.py

Проект работает следующим образом: сначала поднимаются оба сервера,
после них клиенты. Клиенты и сервер общаются с помощью протокола,
описанного в папке proto. Клиент и сервер обеспечивают просмотр всех необходимых данных,
которые были указаны в условие задания, и логируют их локально на каждом контейнере
Чтобы посмотреть статистику по определенному игроку, можно воспользоваться ручками
рест сервера /players/<string:name> и pdfs/<string:name> (вторая вернет ссылку на пдф)
С помощью других ручек можно изменять данных об игроках в бд